openapi: 3.0.3
info:
  title: IKO App API
  description: |
    Comprehensive API for the IKO industrial reporting and management application.
    
    ## Features
    - Employee and attendance management
    - Daily reporting with multiple sections
    - Equipment maintenance tracking
    - Task management for incidents
    - Real-time notifications
    - File upload capabilities
    
    ## Authentication
    **Note**: Currently all endpoints are public. Authentication implementation is recommended.
    
    ## Base URL
    All API endpoints are relative to `/api/`
  version: 1.0.0
  contact:
    name: API Support
    email: support@example.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: /api
    description: Development server

tags:
  - name: Authentication
    description: User authentication and registration
  - name: Users
    description: User management operations
  - name: Reports
    description: Daily report management
  - name: Employees
    description: Employee management
  - name: Attendance
    description: Attendance tracking
  - name: Machines
    description: Machine/equipment inventory
  - name: Maintenance
    description: Equipment maintenance scheduling
  - name: Tasks
    description: Incident task management
  - name: Notifications
    description: User notifications and real-time updates
  - name: Uploads
    description: File upload operations
  - name: Push
    description: Web push notification subscriptions

components:
  schemas:
    # Common schemas
    Error:
      type: object
      properties:
        error:
          type: string
          description: Error message
      required:
        - error
      example:
        error: "Resource not found"

    Success:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Operation completed successfully"

    Pagination:
      type: object
      properties:
        total:
          type: integer
          description: Total number of records
        limit:
          type: integer
          description: Number of records per page
        offset:
          type: integer
          description: Number of records skipped
        hasMore:
          type: boolean
          description: Whether more records are available
        page:
          type: integer
          description: Current page number
        pages:
          type: integer
          description: Total number of pages

    # User schemas
    User:
      type: object
      properties:
        _id:
          type: string
          description: User ID
        name:
          type: string
          description: Full name
        email:
          type: string
          format: email
          description: Email address
        roles:
          type: array
          items:
            type: string
            enum: [admin, reporter, viewer]
          description: User roles
        employeeType:
          type: string
          enum: [permanent, casual]
          description: Employee type
        employeeId:
          type: string
          description: Employee ID
        department:
          type: string
          description: Department name
        phone:
          type: string
          description: Phone number
        hireDate:
          type: string
          format: date
          description: Hire date
        status:
          type: string
          enum: [active, inactive]
          description: User status
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - name
        - email
        - roles
        - employeeType

    UserLogin:
      type: object
      properties:
        email:
          type: string
          format: email
          description: User email
        password:
          type: string
          description: User password
      required:
        - email
        - password

    UserSignup:
      type: object
      properties:
        name:
          type: string
          description: Full name
        email:
          type: string
          format: email
          description: Email address
        password:
          type: string
          minLength: 6
          description: Password (minimum 6 characters)
        role:
          type: string
          enum: [admin, reporter, viewer]
          description: Initial user role
        employeeType:
          type: string
          enum: [permanent, casual]
          default: permanent
        employeeId:
          type: string
          description: Employee ID
        department:
          type: string
          description: Department name
        phone:
          type: string
          description: Phone number
        hireDate:
          type: string
          format: date
          description: Hire date
      required:
        - name
        - email
        - password

    # Employee schemas
    Employee:
      type: object
      properties:
        _id:
          type: string
        name:
          type: string
          description: Employee name
        employeeId:
          type: string
          description: Unique employee identifier
        phone:
          type: string
          description: Phone number
        employeeType:
          type: string
          enum: [permanent, casual]
          description: Employment type
        hireDate:
          type: string
          format: date
          description: Date of hire
        status:
          type: string
          enum: [active, inactive]
          description: Employee status
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - name
        - employeeId

    # Attendance schemas
    Attendance:
      type: object
      properties:
        _id:
          type: string
        employeeId:
          type: string
          description: Reference to Employee
        employeeName:
          type: string
          description: Employee name
        date:
          type: string
          format: date
          description: Attendance date
        shiftType:
          type: string
          description: Type of shift
        signInTime:
          type: string
          description: Sign-in time
        signOutTime:
          type: string
          description: Sign-out time
        createdBy:
          type: string
          description: Who created the record
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - employeeId
        - date
        - shiftType
        - signInTime

    # Machine schemas
    Machine:
      type: object
      properties:
        _id:
          type: string
        name:
          type: string
          description: Machine name
        type:
          type: string
          description: Machine type
        status:
          type: string
          enum: [active, inactive, maintenance]
          description: Machine status
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - name
        - type

    # Equipment Maintenance schemas
    EquipmentMaintenance:
      type: object
      properties:
        _id:
          type: string
        equipmentId:
          type: string
          description: Reference to Machine
        equipmentName:
          type: string
          description: Equipment name
        maintenanceType:
          type: string
          enum: [preventive, corrective, emergency]
          description: Type of maintenance
        priority:
          type: string
          enum: [low, medium, high, critical]
          description: Maintenance priority
        status:
          type: string
          enum: [scheduled, in-progress, completed, cancelled]
          description: Maintenance status
        scheduledDate:
          type: string
          format: date-time
          description: Scheduled maintenance date
        completedDate:
          type: string
          format: date-time
          description: Actual completion date
        description:
          type: string
          description: Maintenance description
        assignedTo:
          type: string
          description: Assigned technician
        estimatedHours:
          type: number
          description: Estimated hours for completion
        actualHours:
          type: number
          description: Actual hours spent
        notes:
          type: string
          description: Additional notes
        createdBy:
          type: string
          description: Who created the record
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - equipmentId
        - maintenanceType
        - priority
        - scheduledDate

    # Report schemas
    Report:
      type: object
      properties:
        _id:
          type: string
        id:
          type: string
          description: Custom report ID (RPT-XXXXXX)
        date:
          type: string
          format: date
          description: Report date
        reportedBy:
          type: string
          description: Reporter name
        reportedByEmail:
          type: string
          format: email
          description: Reporter email
        status:
          type: string
          enum: [draft, submitted, reviewed, approved]
          description: Report status
        powerInterruptions:
          type: object
          description: Power interruption data
        dailyProduction:
          type: object
          description: Daily production data
        incidentReport:
          type: object
          description: Incident report data
        attendance:
          type: object
          description: Attendance data
        siteVisuals:
          type: object
          description: Site visual data
        comments:
          type: array
          items:
            $ref: '#/components/schemas/Comment'
        submittedAt:
          type: string
          format: date-time
        reviewedAt:
          type: string
          format: date-time
        reviewedBy:
          type: string
        approvedAt:
          type: string
          format: date-time
        approvedBy:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - id
        - date
        - reportedBy
        - reportedByEmail

    Comment:
      type: object
      properties:
        id:
          type: string
        author:
          type: string
        role:
          type: string
        text:
          type: string
        timestamp:
          type: string
      required:
        - id
        - author
        - role
        - text

    # Task schemas
    IncidentTask:
      type: object
      properties:
        _id:
          type: string
        title:
          type: string
          description: Task title
        description:
          type: string
          description: Task description
        status:
          type: string
          enum: [open, in-progress, closed]
          description: Task status
        dueDate:
          type: string
          format: date-time
          description: Due date
        reportId:
          type: string
          description: Related report ID
        reportDate:
          type: string
          format: date
          description: Report date
        incidentType:
          type: string
          description: Type of incident
        incidentTime:
          type: string
          description: Time of incident
        taskKey:
          type: string
          description: Unique task key
        assignedToId:
          type: string
          description: Assigned user ID
        assignedToName:
          type: string
          description: Assigned user name
        assignedToEmail:
          type: string
          description: Assigned user email
        createdById:
          type: string
          description: Creator user ID
        createdByName:
          type: string
          description: Creator name
        comments:
          type: array
          items:
            $ref: '#/components/schemas/Comment'
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - title
        - status
        - dueDate
        - reportId
        - taskKey
        - assignedToId

    # Notification schemas
    Notification:
      type: object
      properties:
        _id:
          type: string
        title:
          type: string
          description: Notification title
        message:
          type: string
          description: Notification message
        type:
          type: string
          enum: [report_submitted, attendance_submitted, task_assigned, system]
          description: Notification type
        recipientRoles:
          type: array
          items:
            type: string
            enum: [admin, reporter, viewer]
          description: Target roles
        recipientIds:
          type: array
          items:
            type: string
          description: Target user IDs
        reportId:
          type: string
          description: Related report ID
        reporterName:
          type: string
          description: Reporter name
        attendanceDate:
          type: string
          format: date
          description: Attendance date
        isRead:
          type: boolean
          description: Read status
        createdAt:
          type: string
          format: date-time
      required:
        - title
        - message
        - type

    # Upload schemas
    UploadedFile:
      type: object
      properties:
        name:
          type: string
          description: Original filename
        url:
          type: string
          description: File URL
        type:
          type: string
          enum: [image, video, file]
          description: File type
        size:
          type: string
          description: File size (formatted)
        mimeType:
          type: string
          description: MIME type

    # Push subscription schemas
    PushSubscription:
      type: object
      properties:
        userId:
          type: string
          description: User ID
        roles:
          type: array
          items:
            type: string
            enum: [admin, reporter, viewer]
        subscription:
          type: object
          properties:
            endpoint:
              type: string
              description: Push endpoint URL
            keys:
              type: object
              properties:
                p256dh:
                  type: string
                auth:
                  type: string
              required:
                - p256dh
                - auth
          required:
            - endpoint
            - keys
        userAgent:
          type: string
          description: Browser user agent
      required:
        - userId
        - subscription

paths:
  # Authentication endpoints
  /auth/login:
    post:
      tags:
        - Authentication
      summary: User login
      description: Authenticate user with email and password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserLogin'
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    type: object
                    properties:
                      id:
                        type: string
                      name:
                        type: string
                      email:
                        type: string
                      roles:
                        type: array
                        items:
                          type: string
                      createdAt:
                        type: string
                        format: date-time
                  message:
                    type: string
        '400':
          description: Missing required fields
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /auth/signup:
    post:
      tags:
        - Authentication
      summary: User registration
      description: Register a new user account
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserSignup'
      responses:
        '201':
          description: Account created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    type: object
                    properties:
                      id:
                        type: string
                      name:
                        type: string
                      email:
                        type: string
                      roles:
                        type: array
                        items:
                          type: string
                      createdAt:
                        type: string
                        format: date-time
                  message:
                    type: string
        '400':
          description: Missing required fields
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: User already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  # Users endpoints
  /users:
    get:
      tags:
        - Users
      summary: Get all users
      description: Fetch all users in the system
      responses:
        '200':
          description: Users retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/User'

  /users/update-role:
    put:
      tags:
        - Users
      summary: Update user roles
      description: Update roles for a specific user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: string
                  description: User ID to update
                roles:
                  type: array
                  items:
                    type: string
                    enum: [admin, reporter, viewer]
                  description: New roles for the user
              required:
                - userId
                - roles
      responses:
        '200':
          description: User roles updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    type: object
                    properties:
                      id:
                        type: string
                      name:
                        type: string
                      email:
                        type: string
                      roles:
                        type: array
                        items:
                          type: string
                      createdAt:
                        type: string
                        format: date-time
                  message:
                    type: string
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  # Employees endpoints
  /employees:
    get:
      tags:
        - Employees
      summary: Get all employees
      description: Fetch all employees in the system
      responses:
        '200':
          description: Employees retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Employee'

    post:
      tags:
        - Employees
      summary: Create new employee
      description: Add a new employee to the system
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                employeeId:
                  type: string
                phone:
                  type: string
                employeeType:
                  type: string
                  enum: [permanent, casual]
                hireDate:
                  type: string
                  format: date
              required:
                - name
                - employeeId
      responses:
        '201':
          description: Employee created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/Employee'
        '400':
          description: Invalid request data or duplicate employee ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /employees/{id}:
    put:
      tags:
        - Employees
      summary: Update employee
      description: Update an existing employee
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: Employee ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                employeeId:
                  type: string
                phone:
                  type: string
                employeeType:
                  type: string
                  enum: [permanent, casual]
                hireDate:
                  type: string
                  format: date
                status:
                  type: string
                  enum: [active, inactive]
      responses:
        '200':
          description: Employee updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/Employee'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Employee not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    delete:
      tags:
        - Employees
      summary: Delete employee
      description: Remove an employee from the system
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: Employee ID
      responses:
        '200':
          description: Employee deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '404':
          description: Employee not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /employees/import:
    post:
      tags:
        - Employees
      summary: Bulk import employees
      description: Import multiple employees from CSV file
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: CSV file with employee data
              required:
                - file
      responses:
        '200':
          description: Import completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      imported:
                        type: integer
                      errors:
                        type: array
                        items:
                          type: string
        '400':
          description: Invalid CSV file or format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  # Attendance endpoints
  /attendance:
    get:
      tags:
        - Attendance
      summary: Get attendance records
      description: Fetch attendance records with optional date filtering
      parameters:
        - name: date
          in: query
          schema:
            type: string
            format: date
          description: Filter by specific date (YYYY-MM-DD)
      responses:
        '200':
          description: Attendance records retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Attendance'

    post:
      tags:
        - Attendance
      summary: Create attendance record
      description: Add a new attendance record
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                employeeId:
                  type: string
                date:
                  type: string
                  format: date
                shiftType:
                  type: string
                signInTime:
                  type: string
                signOutTime:
                  type: string
                createdBy:
                  type: string
              required:
                - employeeId
                - date
                - shiftType
                - signInTime
      responses:
        '201':
          description: Attendance record created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/Attendance'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Employee not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /attendance/{id}:
    put:
      tags:
        - Attendance
      summary: Update attendance record
      description: Update an existing attendance record
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: Attendance record ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                shiftType:
                  type: string
                signInTime:
                  type: string
                signOutTime:
                  type: string
                date:
                  type: string
                  format: date
      responses:
        '200':
          description: Attendance record updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/Attendance'
        '404':
          description: Attendance record not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /attendance/submit:
    post:
      tags:
        - Attendance
      summary: Submit attendance notification
      description: Notify admins/viewers that attendance was submitted
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                attendanceDate:
                  type: string
                  format: date
                reporterName:
                  type: string
              required:
                - attendanceDate
      responses:
        '201':
          description: Notification sent successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Success'
        '400':
          description: Missing required fields
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  # Continue with remaining endpoints...
  # (This is a partial implementation - the full spec would be quite large)
  # I'll add the most important endpoints and you can extend as needed

  # Reports endpoints
  /reports:
    get:
      tags:
        - Reports
      summary: Get reports
      description: Fetch reports with filtering and pagination
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum: [draft, submitted, reviewed, approved]
          description: Filter by report status
        - name: reportedByEmail
          in: query
          schema:
            type: string
          description: Filter by reporter email
        - name: date
          in: query
          schema:
            type: string
            format: date
          description: Filter by report date
        - name: includeDrafts
          in: query
          schema:
            type: boolean
          description: Include draft reports
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
          description: Number of records to return
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
          description: Number of records to skip
      responses:
        '200':
          description: Reports retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  reports:
                    type: array
                    items:
                      $ref: '#/components/schemas/Report'
                  pagination:
                    $ref: '#/components/schemas/Pagination'

    post:
      tags:
        - Reports
      summary: Create report
      description: Create a new daily report
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  description: Custom report ID (auto-generated if not provided)
                date:
                  type: string
                  format: date
                reportedBy:
                  type: string
                reportedByEmail:
                  type: string
                  format: email
                status:
                  type: string
                  enum: [draft, submitted]
                  default: draft
                powerInterruptions:
                  type: object
                dailyProduction:
                  type: object
                incidentReport:
                  type: object
                attendance:
                  type: object
                siteVisuals:
                  type: object
              required:
                - date
                - reportedBy
                - reportedByEmail
      responses:
        '201':
          description: Report created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Report'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  # Notifications endpoints
  /notifications:
    get:
      tags:
        - Notifications
      summary: Get notifications
      description: Fetch notifications for a user
      parameters:
        - name: role
          in: query
          required: true
          schema:
            type: string
            enum: [admin, reporter, viewer]
          description: User role
        - name: userId
          in: query
          schema:
            type: string
          description: Specific user ID
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
          description: Number of notifications to return
        - name: unreadOnly
          in: query
          schema:
            type: boolean
          description: Return only unread notifications
      responses:
        '200':
          description: Notifications retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  notifications:
                    type: array
                    items:
                      $ref: '#/components/schemas/Notification'

    post:
      tags:
        - Notifications
      summary: Create notification
      description: Create a new notification
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                message:
                  type: string
                type:
                  type: string
                  enum: [report_submitted, attendance_submitted, task_assigned, system]
                recipientRoles:
                  type: array
                  items:
                    type: string
                    enum: [admin, reporter, viewer]
                recipientIds:
                  type: array
                  items:
                    type: string
                reportId:
                  type: string
                reporterName:
                  type: string
                attendanceDate:
                  type: string
                  format: date
              required:
                - title
                - message
                - type
      responses:
        '201':
          description: Notification created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  notification:
                    $ref: '#/components/schemas/Notification'

  /notifications/stream:
    get:
      tags:
        - Notifications
      summary: Notification stream
      description: Server-Sent Events stream for real-time notifications
      parameters:
        - name: role
          in: query
          schema:
            type: string
            enum: [admin, reporter, viewer]
          description: User role
        - name: userId
          in: query
          schema:
            type: string
          description: User ID
        - name: limit
          in: query
          schema:
            type: integer
            default: 10
          description: Initial notifications to send
        - name: unreadOnly
          in: query
          schema:
            type: boolean
          description: Only unread notifications
      responses:
        '200':
          description: SSE stream established
          content:
            text/event-stream:
              schema:
                type: string
                description: Server-Sent Events stream

  # File upload endpoints
  /uploads:
    post:
      tags:
        - Uploads
      summary: Upload files
      description: Upload one or more files
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                files:
                  type: array
                  items:
                    type: string
                    format: binary
                file:
                  type: string
                  format: binary
      responses:
        '200':
          description: Files uploaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  files:
                    type: array
                    items:
                      $ref: '#/components/schemas/UploadedFile'
        '400':
          description: No files uploaded or file too large
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /uploads/test:
    get:
      tags:
        - Uploads
      summary: Test upload directory
      description: Check upload directory status and list files
      responses:
        '200':
          description: Upload directory status
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  uploadsDir:
                    type: string
                  fileCount:
                    type: integer
                  files:
                    type: array
                    items:
                      type: string
                  message:
                    type: string

  # Push notification endpoints
  /push/subscribe:
    post:
      tags:
        - Push
      summary: Subscribe to push notifications
      description: Register a push notification subscription
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PushSubscription'
      responses:
        '200':
          description: Subscription registered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  vapidPublicKey:
                    type: string
        '400':
          description: Invalid subscription data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /push/unsubscribe:
    post:
      tags:
        - Push
      summary: Unsubscribe from push notifications
      description: Remove a push notification subscription
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                endpoint:
                  type: string
                  description: Push endpoint to remove
              required:
                - endpoint
      responses:
        '200':
          description: Subscription removed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Success'
        '400':
          description: Missing endpoint
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'